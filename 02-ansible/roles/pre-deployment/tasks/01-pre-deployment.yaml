---

- name: actualizar fichero /etc/hosts para resolver DNS
  copy:
    dest: "/etc/hosts"
    content: |
      127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4
      ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6
      {{ ip_master }} {{ hostname_master }} {{ hostname_domain_master }}
      {{ ip_worker01 }} {{ hostname_worker01 }} {{ hostname_domain_worker01 }}
      {{ ip_worker02 }} {{ hostname_worker02 }} {{ hostname_domain_worker02 }}
      {{ ip_nfs }} {{ hostname_nfs }} {{ hostname_domain_nfs }}      
  become: yes
  
- name: establecer zona horaria
  command: timedatectl set-timezone Europe/Madrid

- name: instalar chrony
  dnf:
    name: chrony
    state: latest
  become: yes

- name: habilitar e iniciar chronyd
  systemd: 
    name: chronyd
    state: started
    enabled: yes
    masked: no
  become: yes

- name: habilitar ntp
  command: timedatectl set-ntp true

- name: desactivar SELinux
  command: sed -i s/=enforcing/=disabled/g /etc/selinux/config

- name: instalar paquete nfs-utils
  dnf:
    name: nfs-utils
    state: latest
  become: yes

- name: instalar paquete nfs4-acl-tools
  dnf:
    name: nfs4-acl-tools
    state: latest
  become: yes

- name: instalar paquete wget
  dnf:
    name: wget
    state: latest
  become: yes